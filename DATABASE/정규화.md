# 정규화

정규화란 릴레이션 내의 중복을 제거하는 과정입니다. 정규화를 통해 올바른 데이터만 얻을 수 있고, 불필요한 쿼리를 제거할 수 있습니다.

정규화 단계는 제1정규형에서 제6정규형까지 여러 단계가 있는데, 높은 단계로 갈수록 중복이 적은 릴레이션으로 설계됩니다.

일반적으로 BCNF(보이스코드) 정규형을 목표로 정규화를 진행합니다.

<br>

____

<br>

+ 함수 종속성이란, A의 값을 알면 B의 값을 알 수 있는 관계를 말한다.
+ 부분 함수 종속이란, 종속자가 기본키가 아닌 다른 속성 또는 일부의 기본키에만 종속되는 경우를 말한다.
+ 결합 종속성이란, 여러 개의 릴레이션의 결합으로 처음의 릴레이션을 만들 수 있는 관계를 말한다.
+ 다치 종속이란, 어떠한 조건을 만족하는 튜플이 릴레이션 안에 있을 것을 요구하는 것이다.

### 제1정규화

+ 릴레이션(테이블X)여야 한다.
+ 각 튜플의 속성에는 원자(단 하나의 값)만 들어가야 한다.

| 이름   | 취미           | ->   | 이름   | 취미     |
| ------ | -------------- | ---- | ------ | -------- |
| 홍길동 | 게임           |      | 홍길동 | 게임     |
| 황진이 | 축구           |      | 황진이 | 축구     |
| 김함흥 | 종이접기, 배구 |      | 김함흥 | 종이접기 |
|        |                |      | 김함흥 | 배구     |

> 위의 경우 김함흥의 취미는 종이접기와 배구 두가지이다. 이것을 하나의 튜플에 넣을 것이 아니라 취미를 기준으로 분리하여 각각을 저장해야 한다.

<br>

### 제2정규화

+ 1NF를 만족하는 테이블에서 후보키의 진부분집합(각각 하나의 요소)에서 키가 아닌 속성에 대해, 부분 함수 종속성을 제거하는 것이다.

| 이름 | 학번 | 학과             | 강의실        |
| ---- | ---- | ---------------- | ------------- |
| 이OO | 1010 | 소프트웨어개발과 | 소프트웨어1실 |
| 김OO | 1020 | 정보보안과       | 정보보안2실   |
| 최OO | 1030 | 소프트웨어개발과 | 소프트웨어1실 |

| 이름 | 학번 | 학과             |      | 학과             | 강의실        |
| ---- | ---- | ---------------- | ---- | ---------------- | ------------- |
| 이OO | 1010 | 소프트웨어개발과 |      | 소프트웨어개발과 | 소프트웨어1실 |
| 김OO | 1020 | 정보보안과       |      | 정보보안과       | 정보보안2실   |
| 박OO | 1030 | 소프트웨어개발과 |      |                  |               |

> 위의 경우 강의실은 학번에 종속되는 것이 아니라 학과에 종속됐다. 따라서 아래와 같이 테이블을 분리하여 제2정규형을 만족시켰다.

<br>

### 제3정규화

+ 추이 함수 종속성을 제거하는 작업이다.

  > 추이 함수 종속 : 키가 아닌 X, Y + X를 통해 Y를 알 수 있는 함수 종속이 있다고 할 때, X와 Y를 분리하는 것이다.

+ 제2정규화는 키에 종속하지 않는 속성을 기준으로 테이블을 분리하는 것이고, 제3정규화는 키가 아닌 속성들끼리의 함수 종속을 분리하기 위한 것이다.

| 학번 | 이름 | 우편번호 | 도로명주소                         |
| ---- | ---- | -------- | ---------------------------------- |
| 1010 | 이OO | 14255    | 경기도 서울시 구성구 장동 13-6     |
| 1020 | 김OO | 32415    | 경상남도 용인시 대덕구 어정 16로 8 |

| 학번 | 이름 | 우편번호 |      | 우편번호 | 도로명주소                         |
| ---- | ---- | -------- | ---- | -------- | ---------------------------------- |
| 1010 | 이OO | 14255    |      | 14255    | 경기도 서울시 구성구 장동 13-6     |
| 1020 | 김OO | 32415    |      | 32415    | 경상남도 용인시 대덕구 어정 16로 8 |

> 위의 경우 우편번호를 알면 도로명 주소를 알 수 있으므로 우편번호를 기준으로 분리하였다.

<br>

### BCNF 정규화

+ 3NF를 만족하는 릴레이션에서 키가 아닌 속성의 후보키에 대한 함수 종속성을 제거하는 것이다.
+ 결정자가 아니었던 속성을 결정자로 만드는 것이다.

| 학번 | 교과                      | 교수번호 |      | 교수번호 | 이름  |
| ---- | ------------------------- | -------- | ---- | -------- | ----- |
| 1010 | 알록달록 색종이 접기      | 0001     |      | 0001     | 김교T |
| 1020 | 노래로 공부하는 영어 교실 | 0002     |      | 0002     | 한교T |

| 학번 | 교수번호 |      | 교수번호 | 교과                      | 이름  |
| ---- | -------- | ---- | -------- | ------------------------- | ----- |
| 1010 | 0001     |      | 0001     | 알록달록 색종이 접기      | 김교T |
| 1020 | 0002     |      | 0002     | 노래로 공부하는 영어 교실 | 한교T |

> 위의 경우, 교수는 특정 과목만 가르치기 때문에 교수 번호를 알면 교과를 알 수 있다. 따라서 교수 번호에 대한 교과의 함수 종속성을 제거하고자 다음과 같이 분리하였다.

<br>

### 고급 정규화

+ BCNF에 적합하다면, 제5정규형의 조건도 만족하는 경우가 많다. 따라서 그 이후의 정규화 작업을 진행하지 않는 경우가 많다.

+ 제6정규화는 직교성을 다룰 때 유용하지만, 너무 많은 테이블로 인해 불필요한 join이 많아지므로, 제6정규형을 목표로 두지는 않는다.

  > 직교성 : 하나가 바뀌어도 나머지에 어떤 영향도 주지 않으면 서로 직교한다고 할 수 있다.